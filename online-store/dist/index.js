!function(){"use strict";var e;!function(e){e.InvalidID="Invalid item id"}(e||(e={}));var t=JSON.parse('{"1":{"type":"butter box","color":"blue","pattern":"aks","price":"60","quantity":"3","releaseYear":"2022","manufacturer":"helbak","imageLink":"./images/item-1","id":"1","inCart":false},"2":{"type":"butter box","color":"green","pattern":"revy","price":"60","quantity":"7","releaseYear":"2022","manufacturer":"helbak","imageLink":"./images/item-2","id":"2","inCart":false},"3":{"type":"butter box","color":"petrol","pattern":"pome pome","price":"60","quantity":"9","releaseYear":"2022","manufacturer":"helbak","imageLink":"./images/item-3","id":"3","inCart":false},"4":{"type":"cup","color":"blue","pattern":"linie","price":"40","quantity":"4","releaseYear":"2020","manufacturer":"okle","imageLink":"./images/item-4","id":"4","inCart":false},"5":{"type":"cup","color":"orange","pattern":"revy","price":"20","quantity":"2","releaseYear":"2020","manufacturer":"okle","imageLink":"./images/item-5","id":"5","inCart":false},"6":{"type":"jar","color":"blue","pattern":"fjord","price":"50","quantity":"8","releaseYear":"2019","manufacturer":"okle","imageLink":"./images/item-6","id":"6","inCart":false},"7":{"type":"pitcher","color":"blue","pattern":"pome pome","price":"34","quantity":"10","releaseYear":"2018","manufacturer":"lykke","imageLink":"./images/item-7","id":"7","inCart":false},"8":{"type":"pitcher","color":"blue","pattern":"linie","price":"34","quantity":"4","releaseYear":"2018","manufacturer":"lykke","imageLink":"./images/item-8","id":"8","inCart":false},"9":{"type":"vase","color":"blue","pattern":"linie","price":"47","quantity":"5","releaseYear":"2017","manufacturer":"okle","imageLink":"./images/item-9","id":"9","inCart":false},"10":{"type":"oakwood grinder","color":"yellow","pattern":"no pattern","price":"55","quantity":"2","releaseYear":"2015","manufacturer":"helbak","imageLink":"./images/item-10","id":"10","inCart":false},"11":{"type":"oakwood grinder","color":"grey","pattern":"no pattern","price":"55","quantity":"13","releaseYear":"2015","manufacturer":"helbak","imageLink":"./images/item-11","id":"11","inCart":false},"12":{"type":"oakwood grinder","color":"green","pattern":"no pattern","price":"55","quantity":"9","releaseYear":"2015","manufacturer":"helbak","imageLink":"./images/item-12","id":"12","inCart":false},"13":{"type":"oakwood grinder","color":"blue","pattern":"no pattern","price":"55","quantity":"7","releaseYear":"2015","manufacturer":"helbak","imageLink":"./images/item-13","id":"13","inCart":false},"14":{"type":"oakwood grinder","color":"mint","pattern":"no pattern","price":"55","quantity":"5","releaseYear":"2015","manufacturer":"helbak","imageLink":"./images/item-14","id":"14","inCart":false},"15":{"type":"oakwood grinder","color":"petrol","pattern":"no pattern","price":"55","quantity":"6","releaseYear":"2015","manufacturer":"helbak","imageLink":"./images/item-15","id":"15","inCart":false},"16":{"type":"oakwood grinder","color":"orange","pattern":"no pattern","price":"55","quantity":"1","releaseYear":"2015","manufacturer":"helbak","imageLink":"./images/item-16","id":"16","inCart":false},"17":{"type":"butter box","color":"red","pattern":"aks","price":"60","quantity":"2","releaseYear":"2022","manufacturer":"helbak","imageLink":"./images/item-17","id":"17","inCart":false},"18":{"type":"butter box","color":"red","pattern":"revy","price":"60","quantity":"6","releaseYear":"2022","manufacturer":"helbak","imageLink":"./images/item-18","id":"18","inCart":false},"19":{"type":"butter box","color":"blue","pattern":"revy","price":"60","quantity":"12","releaseYear":"2022","manufacturer":"helbak","imageLink":"./images/item-19","id":"19","inCart":false},"20":{"type":"jar","color":"blue","pattern":"snor","price":"50","quantity":"5","releaseYear":"2019","manufacturer":"okle","imageLink":"./images/item-20","id":"20","inCart":false},"21":{"type":"tea towel","color":"green","pattern":"no pattern","price":"7","quantity":"1","releaseYear":"2020","manufacturer":"lykke","imageLink":"./images/item-21","id":"21","inCart":false}}');class r{constructor(){this.state=new Map(Object.entries(t))}getCurrentState(){return this.state}}class n{constructor(){this.model=new r}getCardsData(){return this.model.getCurrentState()}checkInCart(t){const r=this.getCardsData().get(t);if(null==r)throw new Error(e.InvalidID);return r.inCart}addToCart(t){const r=this.getCardsData().get(t);if(null==r)throw new Error(e.InvalidID);r.inCart=!0}removeFromCart(t){const r=this.getCardsData().get(t);if(null==r)throw new Error(e.InvalidID);r.inCart=!1}getNumOfItemsInCart(){return[...this.getCardsData().values()].filter((e=>e.inCart)).length}getFilterOptions(e){const t=new Set;return this.getCardsData().forEach((r=>t.add(r[e]))),[...t]}getFilteredCardsData(e){const t=new Map(this.getCardsData());for(const r of t.values()){let n=!0;for(const t of e.keys()){const a=e.get(t)||[];0!==a.length&&(a.includes(String(r[t]))||(n=!1))}n||t.delete(r.id)}return t}}class a{constructor(e=["type","a"]){this.sortOrder=e,this.containerElem=document.createElement("section"),this.constructContainer(),this.cardsElem=document.createElement("div"),this.constructCardsElem(),this.noResultsElem=document.createElement("div"),this.constructNoResultsElem(),this.containerElem.append(this.cardsElem,this.noResultsElem)}constructContainer(){this.containerElem.classList.add("grow")}constructCardsElem(){this.cardsElem.classList.add("grid","justify-items-center","grid-cols-3","lg:grid-cols-4","xl:grid-cols-5","gap-y-4","mb-4")}clearCardsElem(){for(;this.cardsElem.firstChild;)this.cardsElem.firstChild.remove()}constructNoResultsElem(){const e=document.createElement("h3"),t=document.createElement("p");this.noResultsElem.classList.add("hidden","flex","flex-col","justify-center","items-center","h-full"),e.classList.add("mb-4","font-medium","text-xl","text-neutral-600"),e.innerText="No matching results",t.classList.add("mb-4","w-3/4","text-sm","text-center"),t.innerText="Unfortunately, no matching items were found. Try resetting the filters.",this.noResultsElem.append(e,t)}showNoResultsElem(){this.noResultsElem.classList.remove("hidden")}hideNoResultsElem(){this.noResultsElem.classList.add("hidden")}draw(e){null!==this.cardsElem&&e.forEach((e=>{const t=document.createElement("div"),r=document.createElement("figure"),n=document.createElement("div"),a=document.createElement("img"),i=document.createElement("figcaption");t.classList.add("relative","h-48","w-44","overflow-hidden","lg:w-52","xl:w-60"),r.classList.add("h-96","hover:-translate-y-1/2","hover:bg-gray-100","transition","duration-500","cursor-pointer"),n.classList.add("flex","justify-center","h-1/2"),i.classList.add("flex","flex-col","justify-evenly","text-center","h-1/2"),r.dataset.id=e.id,r.dataset.inCart=String(e.inCart),a.src=`${e.imageLink}.webp`,a.alt=e.type;const s=new Map(Object.entries(e));for(const[e,t]of s.entries()){if(["imageLink","id","inCart"].includes(e))continue;const r=document.createElement("p");r.classList.add("capitalize"),r.innerText=String(t),r.dataset.field=e,"quantity"===e&&(r.innerText+=" in stock"),"price"===e&&(r.innerText+=" USD"),i.append(r)}n.append(a),r.append(n,i),t.append(r),this.cardsElem.append(t)}))}sort(e,t){const r=[...this.cardsElem.children];this.sortOrder=[e,t],r.sort(((r,n)=>{const a=r.querySelector(`[data-field=${e}]`),i=n.querySelector(`[data-field=${e}]`);if(null==a)return 0;if(null==i)return 0;const s=a.innerText,l=i.innerText;if("type"===e)return"a"===t?s.localeCompare(l):l.localeCompare(s);if("price"===e){const e=Number.parseInt(s),r=Number.parseInt(l);return"lowest"===t?e-r:r-e}return 0})),this.clearCardsElem(),this.cardsElem.append(...r)}redraw(e){this.clearCardsElem(),0!==e.size?(this.hideNoResultsElem(),this.draw(e),this.sort(...this.sortOrder)):this.showNoResultsElem()}}class i{constructor(e=0){this.element=document.createElement("div"),this.constructElement(),this.counter=document.createElement("div"),this.constructCounter(e),this.modal=document.createElement("div"),this.constructModal(),this.element.append(this.counter,this.modal)}constructElement(){this.element.classList.add("flex","flex-col","items-center","gap-x-2","w-20","h-full"),this.element.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="21" height="19" viewBox="0 0 21 19">\n        <g fill="#595859"><path d="M5 6L4 4l4-4 1.6 1.1L5 6zM16 6l1-2-4-4-2 1 5 5zM0 7l2 12h17l2-12H0z"></path></g></svg>'}constructCounter(e){this.counter.classList.add("w-full","text-center","text-blue-400","text-lg","font-semibold"),this.counter.innerText=String(e)}constructModal(){const e=this.modal,t=document.createElement("div"),r=document.createElement("div"),n=document.createElement("h3"),a=document.createElement("p"),i=document.createElement("button");e.classList.add("hidden","fixed","inset-0","flex","justify-center","items-center","bg-gray-900/50","z-10","hover:cursor-pointer"),e.dataset.isModal="true",e.addEventListener("click",(t=>{const r=t.target;null!=r&&r===e&&this.hideModal()})),t.classList.add("flex","flex-col","items-center","px-2","py-3","bg-gray-100","rounded-md","hover:cursor-default"),r.classList.add("flex","self-start","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"),r.innerHTML='\n        <svg class="h-6 w-6 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">\n          <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />\n        </svg>\n      </div>',n.classList.add("mb-4","font-medium","text-xl","text-neutral-600"),n.innerText="Shopping cart is full",a.classList.add("mb-4","w-3/4","text-sm","text-center"),a.innerText="Unfortunately, only up to 20 items can be added at the same time.",i.classList.add("w-20","px-4","py-1","text-md","uppercase","bg-gray-200","border-2","hover:border-blue-300","rounded-md","transition-colors","duration-200"),i.innerText="ok",i.addEventListener("click",(()=>this.hideModal())),t.append(r,n,a,i),e.append(t)}showModal(){this.modal.classList.remove("hidden")}hideModal(){this.modal.classList.add("hidden")}updateCounter(e){this.counter.innerText=String(e)}}class s{constructor(e,t){this.type=e,this.chosenOptions=new Set,this.element=document.createElement("div"),this.constructElement(e),this.listElement=document.createElement("ul"),this.constructOptionList(e,t),this.listElement.addEventListener("change",this.updateChosenOptions.bind(this))}updateChosenOptions(e){const t=e.target;if(null==t)return;if(!(t instanceof HTMLInputElement))return;const r=t.nextElementSibling;if(!(r instanceof HTMLLabelElement))return;const n=r.innerText.toLowerCase();t.checked?this.chosenOptions.add(n):this.chosenOptions.delete(n)}constructElement(e){const t=document.createElement("h4");t.innerText=e,t.classList.add("mb-2","font-medium","text-md","text-neutral-600","capitalize"),this.element.append(t)}constructOptionList(e,t){this.listElement.classList.add("relative","scrollable","overflow-y-auto","px-3","pb-3","h-[5.3rem]","text-sm","text-gray-700"),t.forEach((t=>{const r=document.createElement("li"),n=document.createElement("div"),a=document.createElement("input"),i=document.createElement("label");n.classList.add("flex","items-center","p-1","rounded","hover:bg-gray-100");const s=String(t).split(" ").join("-");a.id=`filter-${e}-${s}`,a.type="checkbox",a.value="",a.classList.add("relative","appearance-none","w-[1.15rem]","h-4","text-blue-600","bg-gray-100","border","border-gray-300","rounded","checked:bg-blue-400","focus:ring-1","focus:ring-blue-400","cursor-pointer"),a.addEventListener("change",(()=>{a.checked?a.classList.add("checked"):a.classList.remove("checked")})),i.innerText=String(t),i.htmlFor=a.id,i.classList.add("ml-2","w-full","text-sm","font-normal","text-gray-500","rounded","capitalize","cursor-pointer"),n.append(a,i),r.append(n),this.listElement.append(r)})),this.element.append(this.listElement)}getChosenOptions(){return[...this.chosenOptions]}}class l{constructor(){this.filters=[],this.element=document.createElement("div"),this.constructElement();const e=document.createElement("h3");e.innerText="Filters",e.classList.add("font-medium","text-xl","text-neutral-600","capitalize","border-b-2","border-blue-400"),this.element.append(e)}constructElement(){this.element.classList.add("flex","flex-col","gap-y-2")}addFilter(e,t){const r=new s(e,t);this.element.append(r.element),this.filters.push(r)}getQuery(){const e=new Map;return this.filters.reduce(((e,t)=>e.set(t.type,t.getChosenOptions())),e)}}class o{constructor(){this.element=document.createElement("div"),this.constructElement(),this.selectElement=document.createElement("select"),this.constructSelect()}constructElement(){const e=document.createElement("h3");e.innerText="sort by",e.classList.add("mb-4","font-medium","text-xl","text-neutral-600","capitalize"),this.element.append(e)}constructSelect(){this.selectElement.classList.add("min-w-[10.5rem]","px-2","py-1","rounded-md","bg-gray-200","capitalize","cursor-pointer"),this.selectElement.name="sort",this.selectElement.append(this.createOption("type-a","name (a - z)"),this.createOption("type-z","name (z - a)"),this.createOption("price-lowest","price (lowest)"),this.createOption("price-highest","price (highest)")),this.element.append(this.selectElement)}createOption(e,t){const r=document.createElement("option");return r.innerText=t,r.value=e,r}}class c{constructor(){this.cards=new a,this.cart=new i,this.sort=new o,this.filters=new l}sortCards(e,t){this.cards.sort(e,t)}drawCards(e){this.cards.draw(e)}getCardsContainer(){return this.cards.containerElem}getCartElement(){return this.cart.element}updateCartCounter(e){this.cart.updateCounter(e)}showCartModal(){this.cart.showModal()}getFiltersContainer(){return this.filters.element}drawFilter(e,t){this.filters.addFilter(e,t)}getSortElement(){return this.sort.element}getSortSelectElement(){return this.sort.selectElement}getFilterQuery(){return this.filters.getQuery()}redrawCards(e){this.cards.redraw(e)}}(new class{constructor(){this.view=new c,this.controller=new n}start(){this.view.drawFilter("type",this.controller.getFilterOptions("type")),this.view.drawFilter("color",this.controller.getFilterOptions("color")),this.view.drawFilter("pattern",this.controller.getFilterOptions("pattern")),this.view.drawFilter("manufacturer",this.controller.getFilterOptions("manufacturer")),this.view.drawCards(this.controller.getCardsData()),this.view.sortCards("type","a"),this.addCartHandler(),this.addSortHandler(),this.addFiltersHandler();const e=document.getElementById("header");null!==e&&e.append(this.view.getCartElement());const t=document.getElementById("mainContent");null!=t&&t.append(this.view.getCardsContainer());const r=document.getElementById("sidebar");null!=r&&r.append(this.view.getSortElement(),this.view.getFiltersContainer())}addCartHandler(){this.view.getCardsContainer().addEventListener("click",(e=>{if(!(e.target instanceof Element))return;const t=e.target.closest("figure");if(null==t)return;const r=t.parentElement;if(null==r)return;const n=t.dataset.id;if(void 0!==n){if(this.controller.checkInCart(n))r.classList.remove("isInCart"),this.controller.removeFromCart(n);else{if(20===this.controller.getNumOfItemsInCart())return void this.view.showCartModal();r.classList.add("isInCart"),this.controller.addToCart(n)}this.view.updateCartCounter(this.controller.getNumOfItemsInCart())}}))}addSortHandler(){const e=this.view.getSortSelectElement();e.addEventListener("change",(()=>{const t=e.options,r=t[t.selectedIndex],[n,a]=r.value.split("-");this.view.sortCards(n,a)}))}addFiltersHandler(){this.view.getFiltersContainer().addEventListener("change",(()=>{const e=this.view.getFilterQuery(),t=this.controller.getFilteredCardsData(e);this.view.redrawCards(t)}))}}).start()}();